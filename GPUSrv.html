<!DOCTYPE html>
<html lang="en">
<head>
    <title>D²</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-148833726-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-148833726-1');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">

    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/ionicons.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">


    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
    <div class="container">
        <a class="navbar-brand" href="index.html"><span>D²</span></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
                aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span> Menu
        </button>

        <div class="collapse navbar-collapse" id="ftco-nav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="publication.html" class="nav-link">Publications</a></li>
                <li class="nav-item"><a href="people.html" class="nav-link">People</a></li>
                <li class="nav-item"><a href="projects.html" class="nav-link">Research Projects</a></li>
                <li class="nav-item"><a href="demos.html" class="nav-link">Research Demos</a></li>
                <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
                <li class="nav-item active"><a href="wiki.html" class="nav-link">Group Wiki</a></li>
                <li class="nav-item"><a href="join.html" class="nav-link">Join Us</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- END nav -->

<section class="hero-wrap hero-wrap-2 js-fullheight" style="background-image: url('images/gpu_server.jpg');"
         data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-end justify-content-center">
            <div class="col-md-9 ftco-animate pb-5 text-center">
                <h1 class="mb-3 bread">Wiki of DrStrange:
                    Group GPU Accelerated Computing Server</h1>
                <p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home <i
                        class="ion-ios-arrow-forward"></i></a></span> <span>Group Wiki <i
                        class="ion-ios-arrow-forward"></i></span> <span>  GPU Instruction <i
                        class="ion-ios-arrow-forward">  </i></span></p>
                <p>Welcome to Wiki for <b>DrStrange</b>, the GPU accelerated computing server in the <a
                        href="http://www.cse.unsw.edu.au">School of Computer Science and Engineering</a> at the <a
                        href="http://www.unsw.edu.au">University of New South Wales</a>. This page should include all
                    basic things about the machine, and more are to be added.
                </p>

            </div>
        </div>
    </div>
</section>

<section class="ftco-section bg-light">
    <div class="container">
        <b>Contents</b>
        <ol>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#start">Getting Started</a></li>
            <ol>
                <li><a href="#access">Accesing the Server</a></li>
                <ol>
                    <li><a href="#ssh_key_gen">Generating SSH Key Pair</a></li>
                    <li><a href="#ssh_login">Login</a></li>
                </ol>

                <li><a href="#start_comp">Starting Computing</a></li>
                <ol>
                    <li><a href="#screen">GNU Screen</a></li>
                    <li><a href="#gpustat">Checking GPU Status</a></li>
                    <li><a href="#gpumask">Masking GPUs</a></li>
                    <li><a href="#tf_mem_growth">TensorFLow: Allowing GPU Memory Growth</a>
                    </li>
                    <li><a href="#userPip">Installing Python Packages in User's Home
                        Directory with
                        pip</a></li>
                </ol>
            </ol>
        </ol>
        <h4 id="overview">Overview</h4>
        DrStrange is a midrange system/ minicomputer customized and purchased for the purpose of conducting massive
        computing tasks for our own group, specifically floating point computation intensive deep learning tasks. It
        currently consists of 2 12-core/ 24-thread Intel(R) Xeon(R) CPU E5-2697 v2 CPUs, 6 NVIDIA TITAN X Pascal GPUs, a
        total 768 GiB memory, and an Intel P3608 SSD( 1.6TB, NVMe PCIe 3.0 X8 HET MLC) with 7 Seagate Enterprise
        Capacity 2.5 HDDs(2TB SATA 6Gb/s 7200rpm 128MB). DrStrange runs standard CentOS 7.
        <br>
        <h5>Global Available software:</h5>
        <p>
            GNU GCC 4.8.5 <br>
            Python 2.7/3.6 with Numpy 1.12.1 , pandas 0.20.1 , tensorflow-gpu 1.0.1 , scikit-tensor 0.1 , scipy 0.19.0
            <br>
            openjdk 1.8.0_131
        </p>

        <h4 id="start">Getting Started</h4>
        <h5 id="access">Accessing the Server</h5>
        <p>DrStrange runs linux, the server can be accessed using
            <a href="https://www.ssh.com/">SSH</a>, thus SSH client is required. Unix based
            systems,
            such as MacOS(Mac OS X), OpenBSD and most Linux distributions, usually already
            have
            OpenSSH
            client included out of box. However, installation of one of such client on
            Microsoft
            Windows
            systems is compulsory. SSH client can be found by your preference, yet here in
            this
            Wiki,
            PuTTY is chosen for demonstration.
        </p>
        <p>
            <b>Note:</b> Password authentication for SSH is disabled due to security
            reasons. Public
            key
            for SSH is required to be sent to one of the administrators, by the time of
            account
            creation,
            change of private key, or requesting authentication of new hosts( Copying
            private key
            file to
            new hosts is also feasible to enable authentication, but not recommended).<br>
            <a href="#ssh_key_gen"><b>Generate a key for SSH</b></a>
        </p>
        <b id="ssh_key_gen">Generating SSH Key Pair</b>
        <p>If you don't have a key pair for SSH yet, please following the instructions to
            generate
            the
            key pair. Otherwise, you can jump to <a href="#ssh_login"><b>Login</b></a>
            section.
        </p>
        <p>Unix based systems aformentioned often have OpenSSH client bultin, which also
            ususally
            shipped with key generators, and its binary excutable is typically called
            `ssh-keygen`.
            A simple exmaple of usage can be as following:
        </p>
        <pre class="well">
    $ ssh-keygen
    Generating public/private rsa key pair.
    Enter file in which to save the key (/home/USERNAME/.ssh/id_rsa):
    Enter passphrase (empty for no passphrase):
    Enter same passphrase again:
    Your identification has been saved in /home/USERNAME/.ssh/id_rsa.
    Your public key has been saved in /home/USERNAME/.ssh/id_rsa.pub.
    The key fingerprint is:
    00:50:7f:29:e2:2c:37:af:b2:8f:cf:e4:50:2f:c8:82 USERNAME@YOURCOMPUTER
    The key's randomart image is:
    +--[ RSA 2048]----+
    |  .oo            |
    |     o   .       |
    |    . + o        |
    |   o . +         |
    |  . *   S        |
    |.. = +           |
    |E + o o          |
    | ..* o           |
    |  o=*            |
    +-----------------+
                            </pre>
        <p>
            Tutorial for "KEY GENERATOR FOR PUTTY ON WINDOWS" can be found
            <a href="https://www.ssh.com/ssh/putty/windows/puttygen"
               target="_blank">here</a>.
        </p>

        <b id="ssh_login">Login</b>
        <p>This section is for ones not familar or have little with Linux systems.
            Experienced users
            can skip by clicking <a href="#start_comp">here</a> to start computing.
        </p>
        <pre class="well">
    $ ssh USERNAME@drstrange.cse.unsw.edu.au
                            </pre>
        <p>As our server is authenticated by SSH keys, you would now logged in, and get
            the message below:
        <p/>
        <pre class="well">
            You are accesing a computer owned by:

                    Service Oriented Computing Group,
                School of Computer Science and Engineering,
                UNSW Sydney

            ***** This service is for authorised clients only *****

     ****************************************************************************
     *                                                                          *
     * WARNING:     It is a criminal offence to:                                *
     *                                                                          *
     *              i.  Obtain access to data without permission                *
     *                        (Penalty 2 years imprisonment)                    *
     *              ii. Damage, delete, alter or insert data without permission *
     *                        (Penalty 10 years imprisonment)                   *
     *                                                                          *
     ****************************************************************************
    Last login: Tue Jul  4 15:56:25 2017 from WHO.KNOW.THIS.COMPUTER
                            </pre>
        <p>Tutorial for "How To Use SSH Keys with PuTTY (Windows users)" can be found
            <a href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-putty-on-digitalocean-droplets-windows-users"
               target="_blank">
                here
            </a>.
        </p>


        <h5 id="start_comp">Starting Computing</h5>
        <p>As the server is accessed via network, and connection outside CSE building can be
            unstable,
            let me first introduce you <a href="https://www.gnu.org/software/screen/">GNU
                Screen</a>.
        </p>
        <b id="screen">GNU Screen</b>
        <p> Screen is
            a full-screen window manager that multiplexes a physical terminal between
            several
            processes,
            typically interactive shells. Thus using Screen can help your remote processes
            survive a
            network disruption. Screen is installed on Drstrange, and you can simply fork
            screen by

        <pre>$ screen</pre>
        a new shell ocuping the whole terminal window should appear, and don't panic, this
        is a new
        instance of shell forked by Screen, your jobs before is not killed and still
        running. In
        this
        Screen-forked shell you can do things as ususal.<br>
        The magic here is you can detach a Screen, and later reattach it. By default, a
        Screen
        session can be deattached by key combination <b>`Ctrl-a`</b> followed by <b>`d`</b>.<br>
        To show a list of Screens invoked,
        <pre>$ screen -ls</pre>
        and it will give you an output similar to this:
        <pre>
    $screen -ls
    There is a screen on:
        11123.pts-1.drstrange	(Detached)
    1 Socket in /var/run/screen/S-USERNAME.
                            </pre>
        In this example 11123 is the pid(Process ID) of the detached Screen, which can be
        reattached
        by
        <pre>$ screen -r 11123</pre>
        and screen with pid 11123 will be reattached, and display as full terminal windows
        size.
        </p>
        <b id="gpustat">Checking GPU Status</b>
        <p>It is generally recommended to check GPU status before running a gpu accelarated
            program,
            so
            that we can avoid interrupting jobs owned by someone else. Also you may not want
            to fork
            your
            job on a busy GPU unit. Check GPU status typically can be done by command <b>`nvidia-smi`</b>.
            While here in our machine, a more user friendly python script is configured and
            of which
            the
            usage is encouraged.<br>
            You can check the usage by
        <pre>$gpustat -cpu</pre>
        which will give you <b>GPU number, GPU name, temprature, GPU ultilization rate,
        memory
        usage,
        user, process name</b> accordingly in different colors.
        </p>
        <b id="gpumask">Masking GPUs</b>
        <p>Some GPU programs are designed to utilize multiple GPUs, and this can largely
            save time
            consumed on trainning massive models. Somehow this often preventing other users
            from
            conducting experiments, especially TensorFlow based ones, which are by default
            allocating
            all available memory at start. As our machine have 6 NVIDIA Titan X pascal GPUs,
            which
            is
            quite powerful, using all 6 GPUs at once is often over-kill. To avoid such
            situation, a
            mask
            can be introduced: <b>`CUDA_VISIBLE_DEVICES`</b>.<br>
            `CUDA_VISIBLE_DEVICES` is an environment variable, which can be simply added in
            frot of
            linux commands at each run. Syntax can be:
        <pre>
    CUDA_VISIBLE_DEVICES=1      //Only device 1 will be seen
    CUDA_VISIBLE_DEVICES=0,1    //Devices 0 and 1 will be visible
    CUDA_VISIBLE_DEVICES=”0,1”  //Same as above, quotation marks are optional
    CUDA_VISIBLE_DEVICES=0,2,3  //Devices 0, 2, 3 will be visible; device 1, 4, 5 is masked
                                 </pre>
        For example, you have a python script call <b>`eg.py`</b>, which you want spawn it
        only on
        <b>`GPU device 0`</b>, this can be done via:
        <pre>$ CUDA_VISIBLE_DEVICES=0 python eg.py</pre>
        </p>

        <b id="tf_mem_growth">TensorFLow: Allowing GPU Memory Growth</b>
        <p>Since Tensorflow is considerably popular in our group and many have not programed
            properly with it
            so far, I feel necessary to propose another handy way to use GPU resource more
            efficiently,
            that is to control the usage of memory, to only grow the memory usage as is
            needed by
            the process.
            This can be done by set parameter <b>`allow_growth`</b> to be <b>`True`</b> when
            starting the
            session.
        <pre>
    config = tf.ConfigProto()
    config.gpu_options.allow_growth = True
    session = tf.Session(config=config, ...)
                            </pre>
        Also, a <b>`per_process_gpu_memory_fraction`</b> option setting up limit of memory
        usage of
        process
        is also quite handy, especially used along with <b>`CUDA_VISIBLE_DEVICES`</b>. An
        example to
        only
        allocate 40% of the total memory of each GPU can be:
        <pre>
    config = tf.ConfigProto()
    config.gpu_options.per_process_gpu_memory_fraction = 0.4
    session = tf.Session(config=config, ...)
                            </pre>

        More details are available
        <a href="https://www.tensorflow.org/tutorials/using_gpu#allowing_gpu_memory_growth"
           target="_blank">
            here
        </a>.
        You may also find <a href="https://petewarden.com/" target="_blank">Pete Warden's
        blog</a>
        interesting.
        </p>

        <b id="userPip">Installing Python Packages in User's Home Directory with pip</b>
        <p>As users on DrStrange normally have no privilege permission( or known as "root"),
            global
            installation
            of Python packages is not practical. Yet enquiry or suggestion on installing
            common
            useful packages
            are encouraged to send to administrators or me Chaoran myself, it is also very
            handy at
            many times,
            to install packages under users' home themselves, which requires no privilege
            permission, and affect
            nothing on others. <br>
            This can be done easily by adding a <b>`--user`</b> option to a normal
            pip3(pip2)
            command. For example:
        <pre>$ pip3 install --user [PACKAGE_NAME]</pre>
        where <b>`[PACKAGE_NAME]`</b> is the one you want to install.
        </p>
    </div>

</section>

<section class="ftco-subscribe" style="background-image: url(images/bg_1.jpg);">
    <div class="overlay">
        <div class="container">
            <div class="row d-flex justify-content-center"></div>
        </div>
    </div>
</section>


<footer class="ftco-footer ftco-footer-2 ftco-section">
    <div class="container">
        <div class="row mb-5">
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <a href="https://www.unsw.edu.au/"><img style=" max-width:80%;" src="images/UNSW_reversed.png"></a>
                </div>
            </div>
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <div class="block-23 mb-3">
                        <ul>
                            <li><span class="icon icon-map-marker"></span><span class="text"> Building K17<br>
                        School of Computer Science and Engineering <br>
						UNSW Sydney, NSW 2052 <br>
						Australia
					</span></li>
                            <li><a href="#"><span class="icon icon-phone"></span><span
                                    class="text"> +61 2 9385 6556</span></a></li>
                            <li><a href="#"><span class="icon icon-envelope"></span><span class="text">lina.yao@unsw.edu.au</span></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">

                <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    Copyright &copy;<script>document.write(new Date().getFullYear());</script>
                    All rights reserved | D² | This template is made with <i class="icon-heart color-danger"
                                                                             aria-hidden="true"></i> by <a
                            href="https://colorlib.com" target="_blank">Colorlib</a>
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
            </div>
        </div>
    </div>
</footer>


<!-- loader -->
<div id="ftco-loader" class="show fullscreen">
    <svg class="circular" width="48px" height="48px">
        <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
        <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                stroke="#F96D00"/>
    </svg>
</div>


<script src="js/jquery.min.js"></script>
<script src="js/jquery-migrate-3.0.1.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/jquery.waypoints.min.js"></script>
<script src="js/jquery.stellar.min.js"></script>
<script src="js/owl.carousel.min.js"></script>
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/aos.js"></script>
<script src="js/jquery.animateNumber.min.js"></script>
<script src="js/bootstrap-datepicker.js"></script>
<script src="js/scrollax.min.js"></script>
<script src="js/google-map.js"></script>
<script src="js/main.js"></script>

</body>
</html>